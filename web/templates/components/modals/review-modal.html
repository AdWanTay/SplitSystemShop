<link rel="stylesheet" href="/web/static/css/elements.css">

<div class="modal">
    <div class="modal-content main-modal">
        <span class="modal-close" onclick="closeAllModals()">✖</span>

        <h2 class="modal-title">Оставить отзыв</h2>

        <div class="modal-body">
            <label for="review">Ваше сообщение</label>
            <textarea id="review" class="modal-textarea" placeholder="Ваше сообщение"></textarea>

            <label>Оцените товар</label>
            <div class="stars" id="rating">
                <span class="star" data-value="1">★</span>
                <span class="star" data-value="2">★</span>
                <span class="star" data-value="3">★</span>
                <span class="star" data-value="4">★</span>
                <span class="star" data-value="5">★</span>
            </div>

            <input type="hidden" id="rating-value" name="rating" value="0">
        </div>

        <div class="modal-actions">
            <button id="mainBtn" class="modal-button primary">Отправить</button>
            <button class="modal-button cancel" onclick="this.closest('.modal').remove()">Отмена</button>
        </div>
    </div>
</div>

<script>
    const stars = document.querySelectorAll('#rating .star');
    const ratingInput = document.getElementById('rating-value');
    let selectedRating = 0;

    stars.forEach((star, index) => {
        // Наведение — временная подсветка
        star.addEventListener('mouseover', () => {
            updateStars(index + 1, 'hovered');
        });

        // Уход мыши — убрать временную подсветку
        star.addEventListener('mouseout', () => {
            updateStars(selectedRating, 'selected');
        });

        // Клик — зафиксировать оценку
        star.addEventListener('click', () => {
            selectedRating = index + 1;
            ratingInput.value = selectedRating;
            updateStars(selectedRating, 'selected');
        });
    });

    function updateStars(rating, className) {
        stars.forEach((s, i) => {
            s.classList.remove('hovered', 'selected');
            if (i < rating) {
                s.classList.add(className);
            }
        });
    }
</script>